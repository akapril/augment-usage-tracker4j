# Augment 使用量监控 - 用户手册

> 适用于所有 JetBrains IDE 的详细使用指南和功能说明

## 📖 目录

1. [快速开始](#快速开始)
2. [功能详解](#功能详解)
3. [设置配置](#设置配置)
4. [状态说明](#状态说明)
5. [交互操作](#交互操作)
6. [故障排除](#故障排除)
7. [常见问题](#常见问题)

## 🚀 快速开始

### 第一步：安装插件
1. 下载 `augment-usage-tracker-idea-1.0.0.zip` 文件
2. 打开任意 JetBrains IDE（IntelliJ IDEA、PyCharm、WebStorm 等）
3. 进入 `文件` → `设置` → `插件`
4. 点击齿轮图标 → `从磁盘安装插件...`
5. 选择下载的 ZIP 文件
6. 重启 IDE

### 第二步：配置 Cookie
1. 登录 [app.augmentcode.com](https://app.augmentcode.com)
2. 按 `F12` 打开开发者工具
3. 切换到 `Application` 标签页
4. 在左侧选择 `Storage` → `Cookies` → `https://app.augmentcode.com`
5. 找到 `_session` 条目，复制其值

### 第三步：插件配置
1. 在 IDEA 中进入 `文件` → `设置` → `工具` → `Augment 使用量监控`
2. 在 `Cookie` 字段中粘贴复制的值
3. 点击 `测试连接` 验证设置
4. 配置刷新间隔（推荐 60 秒）
5. 点击 `确定` 保存设置

### 第四步：开始使用
- 查看 IDE 底部状态栏，应该显示：`用户名: 101/600 ●`
- 鼠标悬停查看详细信息
- 点击状态栏查看完整统计

## 🎯 功能详解

### 状态栏监控
插件在 IDEA 底部状态栏实时显示您的 Augment 使用情况：

**显示格式**：
- `用户名: 当前使用量/总限额 状态图标`
- 例如：`john: 101/600 ●`

**状态图标说明**：
- `●` (实心圆) - 认证正常，数据实时更新
- `⚠` (警告图标) - Cookie 已过期，需要更新
- `未认证` - 尚未配置 Cookie

### 智能工具提示
鼠标悬停在状态栏项目上时，会显示详细信息：

```
Augment 使用量监控

✅ 认证状态：正常

用户信息：
• 邮箱：user@example.com
• 姓名：用户名
• 计划：Community

使用情况：
• 当前用量：101 积分
• 总限额：600 积分
• 使用率：17%
• 剩余额度：499 积分
• 最后更新：2024-12-21 15:30:00

数据来源：Augment API 实时数据
点击查看详细信息或刷新数据
```

### 详细统计对话框
点击状态栏项目会弹出详细统计信息，包含：
- 完整的用户信息
- 详细的使用统计
- 认证状态
- 最后更新时间
- `[刷新数据]` 按钮（正常状态下）

## ⚙️ 设置配置

### 访问设置页面
**方法一**：通过菜单
- `文件` → `设置` → `工具` → `Augment 使用量监控`

**方法二**：通过状态栏（推荐）
- 点击状态栏项目
- 在弹出的对话框中点击 `[打开设置]` 按钮

### 配置选项说明

#### 基本设置
- **启用监控**：开启/关闭插件功能
- **在状态栏显示**：控制状态栏是否显示使用量

#### 认证设置
- **Cookie**：输入从浏览器获取的 `_session` Cookie 值
- **测试连接**：验证 Cookie 是否有效

#### 刷新设置
- **刷新间隔（秒）**：设置自动刷新频率（5-300秒）
- **推荐值**：60秒（平衡实时性和性能）

#### 操作按钮
- **测试连接**：验证当前 Cookie 是否有效
- **刷新数据**：立即获取最新使用量数据
- **清除凭据**：删除已保存的认证信息

## 📊 状态说明

### 正常状态
**显示**：`用户名: 101/600 ●`
**说明**：Cookie 有效，数据正常更新
**操作**：
- 点击查看详细信息
- Ctrl+点击快速刷新

### 过期状态
**显示**：`用户名: 101/600 ⚠`
**说明**：Cookie 已过期，需要更新
**操作**：
- 点击状态栏 → `[打开设置]` → 更新 Cookie
- 重新获取 Cookie 并在设置中更新

### 未认证状态
**显示**：`Augment: 未认证`
**说明**：尚未配置 Cookie
**操作**：
- 点击状态栏 → `[打开设置]` → 配置 Cookie
- 按照快速开始指南获取和配置 Cookie

## 🖱️ 交互操作

### 状态栏交互
根据当前状态，点击状态栏会有不同的响应：

#### 未认证时
```
请配置您的 Augment Cookie 以开始监控使用量。

获取 Cookie 方法：
1. 登录 app.augmentcode.com
2. 按 F12 打开开发者工具
3. 复制 _session Cookie 值

是否现在打开设置页面？

[打开设置] [取消]
```

#### Cookie 过期时
```
⚠️ 您的 Augment Cookie 已过期！

请重新获取 Cookie 并更新设置：

获取方法：
1. 登录 app.augmentcode.com
2. 按 F12 打开开发者工具
3. 复制 _session Cookie 值

是否现在打开设置页面更新 Cookie？

[打开设置] [取消]
```

#### 正常状态时
```
Augment 使用详情

[详细的使用统计信息]

是否立即刷新数据？

[刷新数据] [关闭]
```

### 快捷操作
- **Ctrl + 左键点击**：直接刷新数据（跳过对话框）
- **右键点击**：显示详细信息

## 🔧 故障排除

### 常见问题解决

#### 1. 状态栏不显示插件
**可能原因**：状态栏组件被隐藏
**解决方法**：
1. 右键点击状态栏空白处
2. 确保 "Augment 使用量监控" 已勾选
3. 或进入 `查看` → `外观` → `状态栏小部件` 启用

#### 2. 显示 "未认证"
**可能原因**：Cookie 未配置或格式错误
**解决方法**：
1. 点击状态栏 → `[打开设置]`
2. 重新获取并配置正确的 Cookie
3. 点击 `测试连接` 验证

#### 3. 显示过期警告 ⚠
**可能原因**：Cookie 已过期（通常20小时后过期）
**解决方法**：
1. 点击状态栏 → `[打开设置]`
2. 重新登录 app.augmentcode.com
3. 获取新的 Cookie 并更新设置

#### 4. 数据不更新
**可能原因**：网络连接问题或 API 异常
**解决方法**：
1. 检查网络连接
2. 手动刷新：Ctrl+点击状态栏
3. 查看 IDEA 日志：`帮助` → `在资源管理器中显示日志`

#### 5. 连接测试失败
**可能原因**：Cookie 格式错误或网络问题
**解决方法**：
1. 确认 Cookie 完整复制（包含完整的 JWT token）
2. 检查网络是否可以访问 app.augmentcode.com
3. 尝试重新获取 Cookie

### 日志查看
如需查看详细错误信息：
1. 进入 `帮助` → `在资源管理器中显示日志`
2. 打开 `idea.log` 文件
3. 搜索 "AugmentUsageTracker" 或 "augmentcode"
4. 查看相关错误信息

## ❓ 常见问题

### Q: Cookie 多久会过期？
A: 通常 Augment 的 Cookie 有效期约为 20 小时。插件会自动检测过期状态并提醒您更新。

### Q: 可以设置更频繁的刷新吗？
A: 可以，刷新间隔支持 5-300 秒。但建议不要设置过于频繁（如小于 10 秒），以避免对 API 造成过大压力。

### Q: 插件会影响 IDEA 性能吗？
A: 不会。插件使用异步网络请求，不会阻塞 UI。数据刷新在后台进行，对 IDEA 性能影响极小。

### Q: 支持哪些 IDEA 版本？
A: 支持 IntelliJ IDEA 2023.1 及更高版本，包括 Community 和 Ultimate 版本。

### Q: 数据是否会被泄露？
A: 不会。Cookie 使用 IntelliJ 的 PasswordSafe 加密存储，网络请求直接连接 Augment API，不经过第三方服务器。

### Q: 如何卸载插件？
A: 进入 `文件` → `设置` → `插件`，找到 "Augment 使用量监控"，点击卸载并重启 IDEA。

---

**需要更多帮助？**
- 查看 [README.md](README.md) 了解基本信息
- 查看 [CHANGELOG_ZH.md](CHANGELOG_ZH.md) 了解版本更新
- 提交问题到 [GitHub Issues](https://github.com/akapril/augment-usage-tracker-idea/issues)
